(function(e){"use strict";function t(t,n){var r;var i;var s={delimiter:",",addClassToTag:"",addNewDelimiter:[13,44,188,32],placeholder:"",inputValidation:false,disallowInvalid:false,buttonText:"go",showButton:false,removeDupes:true,showPreviewIcon:false,maxTagLimit:null,maxTagLimitMsg:"Max tag limit reached.",previewTitle:"Click to view the tag values as a string. Useful for copy / paste into other tagify inputs.",style:{},addCb:e.noop,removeCb:e.noop,invalidCb:e.noop};this.opts=e.extend(s,n||{});this.opts.className="tagify-tag";if(e.type(this.opts.addClassToTag)!=="string"){this.opts.addClassToTag=[]}else{this.opts.addClassToTag=this.opts.addClassToTag.split(" ")}if(isNaN(this.opts.maxTagLimit)){this.opts.maxTagLimit=null}if(this.opts.inputValidation){r=e.type(this.opts.inputValidation);if(r==="string"){i=new RegExp(this.opts.inputValidation)}else if(r==="regexp"){i=this.opts.inputValidation}else{i=null}this.inputValidation=i}if(!e.isFunction(this.opts.addCb)){this.opts.addCb=e.noop}if(!e.isFunction(this.opts.removeCb)){this.opts.removeCb=e.noop}this.$originalInput=t;this._tagValues=[];this._tagList=this.splitter(this.$originalInput.val(),true);this.$tagify=this.createTagifyView();this.$tagifyInput=this.$tagify.find(".tagify-input");this.updateOriginalInput();this.setTagifyInputState();this.$originalInput.hide();this.$tagify.insertAfter(this.$originalInput);this.addEvents()}function n(e){var t="input[type=text] textarea".split(" ");var n=true;for(var r=0,i=t.length;r<i;r++){if(!e.is(t[r])){n=false}else{n=true;break}}return n}function r(r){if(e.type(r)==="string"){r=r.toLowerCase();switch(r){case"reset":return this.each(function(){var t=e(this).data("tagify-instance");if(t){t.reset()}});case"getvalues":var i=[];this.each(function(){var t=e(this).data("tagify-instance");e.each(t._tagList,function(e,t){i.push(t.tag)})});return i;default:throw'Specified method "'+r+'" is not provided by the tagify api.'}}return this.each(function(){var i=e(this);if(!n(i)){return}i.data("tagify-instance",new t(i,r))})}t.prototype.setTagifyInputState=function(){if(!this.opts.maxTagLimit){return}var t=this._tagList.length;if(t>=this.opts.maxTagLimit){this.$tagifyInput.attr("disabled",true).attr("placeholder",this.opts.maxTagLimitMsg)}else{this.$tagifyInput.attr("disabled",false).attr("placeholder",this.opts.placeholder)}};t.prototype.splitter=function(n,r){if(!n){return[]}var i=this;var s=n.split(this.opts.delimiter);var o=i.opts.inputValidation;return e.map(s,function(t,n){var s;t=e.trim(t);if(!t){return}if(i.opts.removeDupes){if(e.inArray(t,i._tagValues)!==-1){return}}if(o){s=!o.test(t);if(s&&i.opts.disallowInvalid&&!r){i.opts.invalidCb(t,i.$tagifyInput,e.proxy(i.forceAdd,i));return}}i._tagValues.push(t);return{tag:t,invalid:s}})};t.prototype.forceAdd=function(t){var n=this.opts.disallowInvalid;this.$tagifyInput.val(t);this.opts.disallowInvalid=false;this.$tagifyInput.trigger("forceAdd");this.opts.disallowInvalid=n};t.prototype.updateOriginalInput=function(){this.$originalInput.val(e.map(this._tagList,function(e){return e.tag}).join(this.opts.delimiter))};t.prototype.tagifyInput=function(){var n=e('<div class="tagify-input-container" />');var r=e('<input type="text" class="tagify-input" />');var i;var s;var o;if(this.opts.placeholder){r.attr("placeholder",this.opts.placeholder)}if(this.opts.showPreviewIcon){o=this._tagList.length?"tagify-preview":"tagify-preview-disabled";s=e('<i class="tagify-preview-icon"></i>').addClass(o).attr("title",this.opts.previewTitle);n.append(s)}n.append(r);if(this.opts.showButton){i=e("<button></button>").text(this.opts.buttonText);n.append(i)}if(!e.isEmptyObject(this.opts.style)){r.css(this.opts.style)}return n};t.prototype.generateTag=function(n,r){var i=e("<div />");i.addClass(this.opts.className);if(this.opts.addClassToTag.length){i.addClass(this.opts.addClassToTag.join(" "))}if(r){i.addClass("invalid")}i.text(n);i.append(e('<i class="tagify-remove"></i>'));return i};t.prototype.createTagifyView=function(){var n=this;var r=e("<div />").addClass("tagify");e.each(this._tagList,function(e,t){var i=n.generateTag(t.tag,t.invalid);r.append(i)});r.append(n.tagifyInput());return r};t.prototype.addTagToView=function(t,n){var r=this.generateTag(t,n);this.$tagify.find(".tagify-input-container").before(r)};t.prototype.resetTagifyInput=function(){this.$tagify.find(".tagify-input").val("")};t.prototype.reset=function(){this.resetTagifyInput();this._tagList=[];this._tagValues=[];this.$tagify.find("."+this.opts.className).remove();this.updateOriginalInput()};t.prototype.setPreviewIcon=function(){var t="tagify-preview-disabled tagify-preview";var n=this.$tagify.find(".tagify-preview-icon");n.removeClass(t);if(this._tagList.length){n.addClass("tagify-preview")}else{n.addClass("tagify-preview-disabled")}};t.prototype.addEvents=function(){function t(t){this.resetTagifyInput();var n=this;var r=this.splitter(t);if(!r.length){return}e.each(r,function(e,t){n.addTagToView(t.tag,t.invalid)});e.each(r,function(e,t){n._tagList.push(t)});n.updateOriginalInput();n.setPreviewIcon();n.setTagifyInputState();return r}function n(e,t){var n;for(var r=0,i=t.length;r<i;r++){var s=t[r];if(s.tag===e){n=s;break}}return n}function r(t){var r=n(t,this._tagList);var i=e.inArray(r,this._tagList);var s=e.inArray(r,this._tagValues);if(i!==-1){this._tagList.splice(i,1);this._tagValues.splice(s,1);this.updateOriginalInput();this.setPreviewIcon()}this.setTagifyInputState()}return function(){var i=this;var s=this.opts.addCb;var o=this.opts.removeCb;var u=this.$tagify.find(".tagify-input");this.$tagify.on("click",".tagify-preview",function(e){u.val(i.$originalInput.val());u.focus();u[0].select()});this.$tagify.on("click",".tagify-remove",function(t){var n=e(t.target).closest(".tagify-tag");var s=n.text();r.call(i,s);o.call(i.$originalInput[0],s);n.remove()});this.$tagify.on("blur forceAdd",".tagify-input",function(e){e.preventDefault();var n=i.$tagifyInput;var r=n.val();var o=t.call(i,r);if(o){s.call(i.$originalInput[0],o)}});this.$tagify.on("keypress",".tagify-input",function(n){var r=n.which;var o;if(e.inArray(r,i.opts.addNewDelimiter)!==-1){n.preventDefault();o=i.$tagifyInput;var u=o.val();var a=t.call(i,u);if(a){s.call(i.$originalInput[0],a)}}})}}();e.fn.tagify=r})(jQuery)